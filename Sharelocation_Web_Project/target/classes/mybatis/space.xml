<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
			"http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="space.model.SpaceBean">

	<select id="getSpace" resultType="MySpace">
		select * from space
		where num = #{num}
	</select>

	<insert id="addFavorite">
		insert into favorite
		values(favorite_seq.nextval, #{spacenum},#{membernum})
	</insert>

	<select id="getSpaceList" resultType="MySpace">
		select * from space
		where name like #{keyword}
		<if test="whatColumn!=null">
  		and type like #{whatColumn}
  		</if>
		order by num desc
	</select>
	
	<select id="getTotalCount" resultType="int">
		select count(*) from space
		where name like #{keyword}
		<if test="whatColumn!=null">
  		and type like #{whatColumn}
  		</if>
	</select>



	<delete id="delFavorite">
		delete from favorite
		where spaceNum = #{spaceNum} and membernum = #{membernum}
	</delete>

	<insert id="insertSpace">
		insert into space(num, membernum, name, type,
		contentssim, contentscom, warning, mainimage,
		site, address, email, hp,
		operatingtime, operatingendtime, holiday, grade, status, regdate)
		values
		(space_seq.nextval, #{membernum}, #{name}, #{type}, #{contentssim}, #{contentscom},
		#{warning}, #{mainimage},
		#{site}, #{address}, #{email}, #{hp},
		#{operatingtime}, #{operatingendtime}, #{holiday,jdbcType=VARCHAR},
		#{grade}, #{status}, sysdate)
	</insert>

	<select id="getRecentSpaceNum" resultType="int">
		select num from
		(select * from space order by rownum desc) where rownum = 1
	</select>

	<insert id="insertSpaceImage">
		insert into spaceimage values(spaceimage_seq.nextval,
		#{spacenum}, #{image})
	</insert>

	<insert id="insertSpaceFacility">
		insert into spacefacility
		values(spacefacility_seq.nextval, #{spacenum}, #{facility})
	</insert>

	<select id="getSpaceListByMemberNum" resultType="MySpace">
		select * from
		space where membernum = #{memberNum} order by rownum
	</select>

	<select id="getSpaceImageListBySpaceNum"
		resultType="MySpaceImage">
		select * from spaceimage where spacenum = #{spaceNum} order
		by rownum

	</select>

	<select id="getImage" resultType="MySpaceImage">
		select * from spaceimage
		where
		spacenum = #{num}
	</select>
	<select id="getFacility" resultType="MySpaceFacility">
		select * from spacefacility
		where spacenum=#{num}
	</select>


</mapper>